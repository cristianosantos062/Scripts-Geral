USE BANCO
GO

-- QUERY PARA GERAR O SCRIPT DE PERMISSÕES NO SQL 2000
SELECT 'GRANT ' +A.NAME+ ' ON ' +'[' +U.NAME + ']' +'.' +'[' +C.NAME + ']' + ' TO ' +D.NAME FROM MASTER..SPT_VALUES A 
LEFT JOIN SYSPROTECTS B ON A.NUMBER = B.ACTION
JOIN SYSOBJECTS C ON B.ID = C.ID
JOIN SYSUSERS D ON B.UID = D.UID
JOIN SYSUSERS U ON U.UID = B.GRANTOR
WHERE A.TYPE = 'T' AND
C.TYPE <> 'S' AND
C.NAME NOT LIKE 'DT%' AND
C.NAME NOT LIKE 'SYS%'
